{
  "hash": "2380529c877a4b7def0535a336b5e3b4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"RF sense\"\ndate: 2022-04-13\n---\n\n\nAs part of another circuit I'm trying to design, I would like to have a\nhigh impedance detection of whether there is RF on the wire (this would\nbe for a lab 10MHz distribution amp). I believe the following circuit \nshould do: \n\n![](images/rfsense.png){width=600px}\n\nAfter the 50-ohm load (for the experiment, not for the final design, just\nto terminate the signal generator in the testing), there are two \nSchottky diodes to rectify the signal, and then (R2,C3) filter the output\ninto the comparator negative input. If we start from a low RF level state, \nthe rectified RF is compared to a voltage of \n$4.7/(4.7+47) \\cdot 5V = 0.45V$.  That corresponds to around 3 dBm.  \n\nWhen the RF is lower, the positive input is higher, and the comparator\nlets its output go high, and there is no voltage to light the LED. \nBut when the rectified RF goes above 3 dBm, the comparator opens\nthe collector, and there is sufficient voltage to light the LED. Now\nR5 is also almost paralleled with R4, pulling the positive reference input\ntowards ground (except for $V_{CE}$ of the output transistor of the comparator).\nThat provides some hysteresis in the detection of RF by the LED. \n\nI built the circuit on one of the prototyping boards I had JLCPCB made from \nthe Gerber files that \n[Ryan Flower, W7RLF, have made available](https://miscdotgeek.com/a-new-prototyping-pcb-for-qrp-homebrew-radio/):\n\n![Picture of built prototype board.](images/2022-04-13_rfsense_build_small.jpg){width=600px}\n\nAll the diamond shapes on the board are connected to a ground plane on the back\nside of the board. The LM339 (the only comparator I had around in a DIP package)\nis superglued dead-bug style to the board. After fixing a bad solder joint, \nI could make the following measurements, using my HP signal generator for \nfine power adjustments:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lshpfsgopn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lshpfsgopn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lshpfsgopn thead, #lshpfsgopn tbody, #lshpfsgopn tfoot, #lshpfsgopn tr, #lshpfsgopn td, #lshpfsgopn th {\n  border-style: none;\n}\n\n#lshpfsgopn p {\n  margin: 0;\n  padding: 0;\n}\n\n#lshpfsgopn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lshpfsgopn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lshpfsgopn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lshpfsgopn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lshpfsgopn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lshpfsgopn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lshpfsgopn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lshpfsgopn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lshpfsgopn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lshpfsgopn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lshpfsgopn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lshpfsgopn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lshpfsgopn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lshpfsgopn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lshpfsgopn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lshpfsgopn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lshpfsgopn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lshpfsgopn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lshpfsgopn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lshpfsgopn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lshpfsgopn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lshpfsgopn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lshpfsgopn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lshpfsgopn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lshpfsgopn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lshpfsgopn .gt_left {\n  text-align: left;\n}\n\n#lshpfsgopn .gt_center {\n  text-align: center;\n}\n\n#lshpfsgopn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lshpfsgopn .gt_font_normal {\n  font-weight: normal;\n}\n\n#lshpfsgopn .gt_font_bold {\n  font-weight: bold;\n}\n\n#lshpfsgopn .gt_font_italic {\n  font-style: italic;\n}\n\n#lshpfsgopn .gt_super {\n  font-size: 65%;\n}\n\n#lshpfsgopn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lshpfsgopn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lshpfsgopn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lshpfsgopn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lshpfsgopn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lshpfsgopn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lshpfsgopn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lshpfsgopn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lshpfsgopn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Frequency-(MHz)\">Frequency (MHz)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Turn-on-(dBm)\">Turn on (dBm)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Turn-off-(dBm)\">Turn off (dBm)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Frequency (MHz)\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Turn on (dBm)\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"Turn off (dBm)\" class=\"gt_row gt_right\">2.7</td></tr>\n    <tr><td headers=\"Frequency (MHz)\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Turn on (dBm)\" class=\"gt_row gt_right\">3.4</td>\n<td headers=\"Turn off (dBm)\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Frequency (MHz)\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Turn on (dBm)\" class=\"gt_row gt_right\">3.4</td>\n<td headers=\"Turn off (dBm)\" class=\"gt_row gt_right\">3.0</td></tr>\n    <tr><td headers=\"Frequency (MHz)\" class=\"gt_row gt_right\">20</td>\n<td headers=\"Turn on (dBm)\" class=\"gt_row gt_right\">3.6</td>\n<td headers=\"Turn off (dBm)\" class=\"gt_row gt_right\">3.1</td></tr>\n    <tr><td headers=\"Frequency (MHz)\" class=\"gt_row gt_right\">30</td>\n<td headers=\"Turn on (dBm)\" class=\"gt_row gt_right\">4.2</td>\n<td headers=\"Turn off (dBm)\" class=\"gt_row gt_right\">3.8</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nSo this is more or less as the calculations implied, so this must count \nas some success. There seems to be some additional attenuation at higher\nfrequencies, with higher power needed to turn the LED on.\nI measure the relevant voltages to see if my hypotheses were correct:\n\n- When the RF on LED lights up, I measure 1.89V over the green LED (I should\nput a smaller resistance to get a bit more light from this). There are 3V over\nthe resistor R6, and only 75 mV at the comparator output. The reference\nvoltage at the +IN pin of the comparator measures 448 mV. \n- When the RF on LED turns off, I measure 3.32V at the comparator output, and 477\nmV at +IN.\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}