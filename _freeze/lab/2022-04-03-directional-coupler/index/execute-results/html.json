{
  "hash": "e521565e9a85afc5cd1b107994c0aca0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Experiments with a directional coupler\ndate: 2022-04-03\ncategories: [station-power-meter]\n---\n\n\n\n\nIt has been a radio weekend. Not only have worked a bit of HF (including \nMorocco and the Canary Islands!), but I have finally gotten around to winding\ntransformers for the directional coupler of a station power/SWR meter.  A while\nback I ordered a batch of PCBs for DJ0ABRs power meter \n[U02 - Power / SWR measuring coupler](https://youtu.be/hSHQAcMrIEk).  It was \ndesigned to be part of his kilo-Watt amplifier. This seemed like a good \nidea at the time. \n\n# Design and build\n\nThe main design concept is to use a tandem match directional coupler, \nand then use highly sensitive AD8307 log amplifier to measure the forward\nand the reflected power. \n[Alan Wolke, W2AEW, has an explanation of how this coupler works.](https://youtu.be/byF1FLdbUiA) \nThe AD8307 log amplifier I have used also as part of my stand-alone lab \npower meter (still need to fix some software bugs).\n\n![Schematic of coupler.](images/LRM_20220403_145820.jpg){width=600px}\n\nThe schematics of the coupler is not complicated, but I only feel I understand\nit fully in short glimpses. The core idea is to sense both current and voltage\nin the line from A to B, and that can be measured over C and D to give us the \nforward and the reflected power. The full design then use 50 Ohm terminations \nand an AD8307 each at C and D for the RF measurements. The two transformers \nare $1:N$ turns (with the one turn being a coax through the center of \nring ferrite cores that have the $N$ windings). There is also an electrostatic\nshield connected to ground. \n\nI built it up on one of the board I had ordered. Everything looks\nvery good on the nano VNA - fully terminated, the return loss at the transmitter\nport is 35 dB or more.\n\n![Picture of coupler and VNA.](images/LRM_20220403_133731.jpg){width=600px}\n\n# Measurements\n\n\n\nFor measurements, I used the TinySA spectrum analyzer. I put -10dBm into\nthe transmitter port at 50MHz, varied the load impedance, and measured the power\nin the forward and the reflected port (taking care that the measurement\nport that wasn't connected was terminated with 50 Ohm). \n\nHere are the measurements, Power is measured in dBm and the calculated \nreturn loss (RL) in dB:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"leshbtrhel\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#leshbtrhel table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#leshbtrhel thead, #leshbtrhel tbody, #leshbtrhel tfoot, #leshbtrhel tr, #leshbtrhel td, #leshbtrhel th {\n  border-style: none;\n}\n\n#leshbtrhel p {\n  margin: 0;\n  padding: 0;\n}\n\n#leshbtrhel .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#leshbtrhel .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#leshbtrhel .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#leshbtrhel .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#leshbtrhel .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#leshbtrhel .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#leshbtrhel .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#leshbtrhel .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#leshbtrhel .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#leshbtrhel .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#leshbtrhel .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#leshbtrhel .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#leshbtrhel .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#leshbtrhel .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#leshbtrhel .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#leshbtrhel .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#leshbtrhel .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#leshbtrhel .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#leshbtrhel .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#leshbtrhel .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#leshbtrhel .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#leshbtrhel .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#leshbtrhel .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#leshbtrhel .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#leshbtrhel .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#leshbtrhel .gt_left {\n  text-align: left;\n}\n\n#leshbtrhel .gt_center {\n  text-align: center;\n}\n\n#leshbtrhel .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#leshbtrhel .gt_font_normal {\n  font-weight: normal;\n}\n\n#leshbtrhel .gt_font_bold {\n  font-weight: bold;\n}\n\n#leshbtrhel .gt_font_italic {\n  font-style: italic;\n}\n\n#leshbtrhel .gt_super {\n  font-size: 65%;\n}\n\n#leshbtrhel .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#leshbtrhel .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#leshbtrhel .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#leshbtrhel .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#leshbtrhel .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#leshbtrhel .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#leshbtrhel .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#leshbtrhel .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#leshbtrhel div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"frequency\">frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pin\">Pin</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pforward\">Pforward</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Preflected\">Preflected</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rload\">Rload</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"RL\">RL</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-32.0</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-56.0</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">24.0</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-32.0</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-32.0</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">open</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">0.0</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-32.0</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-33.0</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">short</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">1.0</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31.5</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-42.3</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">25R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">10.8</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nNote that R presents this with a bit more apparent precision that is called for.\n\nTo the results:\n\n1. With proper termination, we measure 22 dB down in the forward direction. Since\n1/12 in voltage correspond to $-20 \\log_{10}(12)=-21.6$ dB, that is reasonable.\nA return loss of 24 is quite good, corresponding to a SWR of about 1.1.\n2. With an open load, all power is reflected, as expected.\n3. The short was improvised with a pair of tweezer in the BNC jack. At 50MHz \nprobably imperfect. So a tiny bit of return loss.\n4. With two 50 Ohm loads in parallel (on a T adapter), the return loss was 11 dB.\nand the short (implemented with a pair of tweezers) was probably not a good\nRF short. Theoretically, the return loss should be $-20 \\log_{10} \\Gamma$, with\n$\\Gamma$ being the reflection coefficient. With a purely resistive load of 25 Ohm, \n$\\Gamma  = |25 - 50|/|25 + 50| = 1/3$, and the calculated return loss should be \n9.5. Instead I measure more than one dB more. But with the return loss being\nthe difference between two imprecise measurements, I don't think this is a \nsomething to worry about. \n\n\nI also kept the input constant at -10 dBm and varied the frequency from 1 to\n90 MHz: \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pscnnasidr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pscnnasidr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pscnnasidr thead, #pscnnasidr tbody, #pscnnasidr tfoot, #pscnnasidr tr, #pscnnasidr td, #pscnnasidr th {\n  border-style: none;\n}\n\n#pscnnasidr p {\n  margin: 0;\n  padding: 0;\n}\n\n#pscnnasidr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pscnnasidr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pscnnasidr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pscnnasidr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pscnnasidr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pscnnasidr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pscnnasidr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pscnnasidr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pscnnasidr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pscnnasidr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pscnnasidr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pscnnasidr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pscnnasidr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pscnnasidr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pscnnasidr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pscnnasidr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pscnnasidr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pscnnasidr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pscnnasidr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pscnnasidr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pscnnasidr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pscnnasidr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pscnnasidr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pscnnasidr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pscnnasidr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pscnnasidr .gt_left {\n  text-align: left;\n}\n\n#pscnnasidr .gt_center {\n  text-align: center;\n}\n\n#pscnnasidr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pscnnasidr .gt_font_normal {\n  font-weight: normal;\n}\n\n#pscnnasidr .gt_font_bold {\n  font-weight: bold;\n}\n\n#pscnnasidr .gt_font_italic {\n  font-style: italic;\n}\n\n#pscnnasidr .gt_super {\n  font-size: 65%;\n}\n\n#pscnnasidr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pscnnasidr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pscnnasidr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pscnnasidr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pscnnasidr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pscnnasidr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pscnnasidr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pscnnasidr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pscnnasidr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"frequency\">frequency</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pin\">Pin</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pforward\">Pforward</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Preflected\">Preflected</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Rload\">Rload</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"RL\">RL</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-32</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-63</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">31</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-64</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">33</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">20</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-30</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-61</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">31</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">30</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-61</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">30</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">40</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-58</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">27</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">50</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-57</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">26</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">60</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-31</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-55</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">24</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">70</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-33</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-55</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">22</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">80</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-34</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-56</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">22</td></tr>\n    <tr><td headers=\"frequency\" class=\"gt_row gt_right\">90</td>\n<td headers=\"Pin\" class=\"gt_row gt_right\">-10</td>\n<td headers=\"Pforward\" class=\"gt_row gt_right\">-45</td>\n<td headers=\"Preflected\" class=\"gt_row gt_right\">-66</td>\n<td headers=\"Rload\" class=\"gt_row gt_left\">50R</td>\n<td headers=\"RL\" class=\"gt_row gt_right\">21</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nRespecting the accuracy of the measurements, it seems that the the coupler\nbehaves well up to 60-70 MHz, and the gross deviations from linearity only\nhappens above 80 MHz. I am quite happy about this. \n\n# Design considerations going forward \n\nThe important question is how turns should be wound on the transformers. \nDJ0ABR design with 24 turns, for a 2kW capacity. I have no planned need\nto measure that large amount of power, and there are two costs to having too\nmany turns: First, there is limited dynamic range in the measurement system.\nSecond, more turns will degrade performance of the transformers at higher \nfrequencies. \n\nOne place to start is with the capacity of the \n[AD8307](https://www.analog.com/en/products/ad8307.html). It is specified \nto measure up to 17 dBm and down to -75 dBm. I would also like to have \naccurate measure of return loss with QRP rigs running perhaps only 1W. I try\nto calculate some scenarios.\n\nFirst, let's vary the number of turns from 10 to 30. Then, I would like \nto measure the reflected power for a good match with a return loss of 25 dB.\nI calculate what forward and reflected powers I'll need to have the sensor\nread for different powers from the transmitter and see how this range\nfits within the dynamic range of AD8307. \n\nNote that there is also a voltage divider in front of the AD8307\nin DJ0ABR's design. This also involves a coupler of DC blocker \ncapacitors, but these are large and basically shorts at \nRF. The internal impedance of AD8307 is, according to the \ndatasheet, about 1k1 Ohm. In the design, this is paralleled\nwith an 180R resistor, giving a parallel resistance\nof 155. This is the lower leg of a divider\nwith 470R in the upper leg, so the voltage division\nis by a factor of around 4,\nor -12.1 dB.\n\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nI don't completely understand how DJ0ABR can use this design to \nmeasure up to 2 kW with only 24 turns. Maybe the resistor network \nin front of the chip could be adjusted, or maybe a modification\nis called for. \n\nIf I were to change anything about the design, I think that I also\nwould like to create a bit more space for the transformers. The 1-turn\nof coax through the ferrite cores makes it difficult to solder the very\nshort piece of the shield without melting the coax. Perhaps it is my Ultraflex\ncoax that doesn't take heat well, but putting things together would be easier \nwith more space. Maybe that would compromise the coupler at VHF. But if I could\nrun with fewer turns on the transformer, I think that would make more of a\ndifference at 50 (and maybe 70) Mhz.\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}